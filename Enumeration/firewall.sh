#! /bin/bash

FIREWALL_CMD=$(which firewall-cmd)
SYSTEMCTL=$(which firewall-cmd)

#3.4.2.1
function firewalldEnabled {

if [[ $FIREWALL_CMD == "no $FIREWALL_CMD*" ]]; then
firewalldEnabledRest=("3.4.2.1" true "N/A" "Firewalld no installed")
else
    firewallStatus=$($FIREWALL_CMD --state)
    if [[ $firewallStatus != "running" ]]; then
    firewalldEnabledRest=("3.4.2.1" false "A" "Firewalld not running")
    else
    firewalldEnabledRest=("3.4.2.1" true "A" "Firewalld running")
    fi
fi

}


#3.4.2.2
function iptablesEnabled {

if [[ $SYSTEMCTL == "no $SYSTEMCTL*" ]]; then
    echo "systemctl no est√° instalado"
else
    iptablesStatus=$($SYSTEMCTL is-enabled iptables)
fi


if [[ $iptablesStatus == "*iptables.service*" ]]; then 
    iptablesEnabledRest=("3.4.2.2" false "A" "IPTABLES no esta instalado como servicio")
elif [[  $iptablesStatus != "enabled" ]]; then
    echo 
    iptablesEnabledRest=("3.4.2.2" false "A" "IPTABLES not running")
else
    iptablesEnabledRest=("3.4.2.2" true "A" "IPTABLES running")
fi
}
