import re, sys, subprocess

# python3 whichSystem.py <ipaddr>

def get_ttl(ipAddr):

    cmd = "ping -c 1 %s" % (ipAddr)
    proc = subprocess.Popen(["ping -c 1 127.0.0.1"], stdout=subprocess.PIPE, shell=True)
    (out, err) = proc.communicate()

    out = out.split()
    out = out[12].decode('utf-8')

    ttlValue = re.findall(r"\d{1,3}", out)[0]

    return ttlValue

def get_os(ttl):
    ttl = int(ttl)

    if(ttl >= 0 and ttl <= 64):
        return "Linux"
    elif (ttl >= 65 and ttl <= 128):
        return "Windows"

if __name__ == '__main__':

    try:
        if len(sys.argv) != 2:
            raise Exception()

        ipAddr = sys.argv[1]

        ttl = get_ttl(ipAddr)

        get_os(ttl)
    except Exception:
        print('[!] Uso errÃ³neo de la herramienta. \n\t[Example] Uso: python3 ' + sys.argv[0] + ' <IP Address>\n')
        sys.exit(1)